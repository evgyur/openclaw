---
name: telegram
description: |
  Telegram integration для Clawdbot через HTTP API. Используй когда пользователь хочет:
  (1) Проверить непрочитанные сообщения в Telegram
  (2) Получить дайджест сообщений
  (3) Отправить сообщение в Telegram
  (4) Найти сообщения в чатах
  Триггеры: "telegram", "непрочитанные сообщения", "дайджест telegram", 
  "отправить в telegram", "найти в telegram"
metadata: {"clawdbot":{"always":false}}
---

# Telegram Skill для Clawdbot

Интеграция с Telegram через HTTP API (telegram-mcp-api).

## API Endpoints

API работает на `http://localhost:8080`. Доступные endpoints:

- `GET /health` - проверка работоспособности
- `GET /me` - информация о текущем пользователе
- `GET /chats` - список чатов
- `GET /chats/{id}` - информация о чате
- `GET /chats/{id}/messages` - сообщения из чата
- `POST /messages/send` - отправить сообщение
- `POST /messages/search` - поиск сообщений

## Использование

### 1. Проверка непрочитанных сообщений

Когда пользователь спрашивает про непрочитанные сообщения:

1. Получи список чатов: `curl http://localhost:8080/chats`
2. Для каждого чата проверь наличие непрочитанных сообщений
3. Получи сообщения из чатов с непрочитанными: `curl http://localhost:8080/chats/{chat_id}/messages`
4. Сформируй дайджест непрочитанных сообщений

**Пример запроса:**
```bash
curl -s http://localhost:8080/chats | python3 -m json.tool
```

### 2. Получение дайджеста

Когда пользователь просит дайджест:

1. Получи список всех чатов
2. Для каждого чата получи последние сообщения
3. Сгруппируй по приоритетам:
   - Прямые упоминания
   - Вопросы, требующие ответа
   - Обновления и новости
   - Низкий приоритет (FYI)

### 3. Отправка сообщения

Когда пользователь хочет отправить сообщение:

```bash
curl -X POST http://localhost:8080/messages/send \
  -H "Content-Type: application/json" \
  -d '{"chat_id": 123456, "message": "Текст сообщения"}'
```

### 4. Поиск сообщений

```bash
curl -X POST http://localhost:8080/messages/search \
  -H "Content-Type: application/json" \
  -d '{"chat_id": 123456, "query": "поисковый запрос", "limit": 20}'
```

## Формат ответов API

Все ответы в формате:
```json
{
  "success": true,
  "data": "...",
  "error": null
}
```

При ошибке:
```json
{
  "success": false,
  "data": null,
  "error": "описание ошибки"
}
```

## Важно

- API работает на `http://localhost:8080`
- Все запросы делай через `curl` или HTTP запросы
- При ошибках API проверь статус сервиса: `systemctl --user status telegram-api.service`
- Для отправки сообщений всегда спрашивай подтверждение у пользователя

## Примеры использования

**Пользователь:** "Есть ли у меня непрочитанные сообщения в Telegram?"

**Действия:**
1. Выполни команду: `curl -s http://localhost:8080/health` (через exec)
2. Выполни команду: `curl -s http://localhost:8080/chats` (через exec)
3. Проанализируй JSON ответ и найди чаты с непрочитанными сообщениями
4. Для каждого чата выполни: `curl -s http://localhost:8080/chats/{chat_id}/messages`
5. Сформируй структурированный ответ пользователю с дайджестом

**Пользователь:** "Покажи дайджест моих Telegram сообщений"

**Действия:**
1. Получи все чаты
2. Для каждого чата получи последние сообщения
3. Сформируй структурированный дайджест с приоритетами
4. Представь в удобном формате
